---
import Base from '../layouts/Base.astro';
import BlogCard from '../components/BlogCard.astro';
import BlogLayout from '../layouts/BlogLayout.astro';

const allPosts = await Object.entries(
  import.meta.glob('./posts/*.md', { eager: true })
);
---

<Base pageTitle="Blog">
  <div class="container">
    <h1>Blog</h1>
    <!-- <nav>
      <ul>
        {
          allPosts.map((post: any) => (
            <li>
              {
                <a class="post__link" href={post[1].url}>
                  {post[1].frontmatter.title}
                </a>
              }
            </li>
          ))
        }
      </ul>
    </nav> -->
    <ul class="blog-posts">
      {
        allPosts.map((post: any) => (
          <li>
            <BlogCard
              postUrl={post[1].url}
              postTitle={post[1].frontmatter.title}
              postAuthor={post[1].frontmatter.author}
              postDate={post[1].frontmatter.pubDate}
              postTags={post[1].frontmatter.tags}
              postContent={post[1].compiledContent}
            />
          </li>
        ))
      }
    </ul>
  </div>
</Base>

<style>
  .container {
    max-width: 1200px;
    min-width: 320px;
    width: 100%;
    margin: 0 auto;
    padding-block: 2rem;
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .blog-posts {
    list-style: none;
  }
</style>

<script>
  const allPosts = await Object.entries(
    import.meta.glob('./posts/*.md', { eager: true })
  );

  allPosts.forEach(post => console.log(post[1]));
</script>
